<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Submitting jobs &mdash; KFF Tungregning</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/togglebutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="History" href="history.html" />
    <link rel="prev" title="Home directory" href="home_directory.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            KFF Tungregning  
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="access.html">Access and login</a></li>
<li class="toctree-l1"><a class="reference internal" href="home_directory.html">Home directory</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Submitting jobs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#srun">srun</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#syntax">Syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#an-example">An example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sbatch">sbatch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">An example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#salloc">salloc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">Syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-1-cpu">Example 1: CPU</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-2-gpu">Example 2: GPU</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#other-useful-slurm-commands">Other useful Slurm commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#squeue">squeue</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sinfo">sinfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scancel">scancel</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="software.html">Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="python.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="jupyterhub.html">JupyterHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="lammps.html">LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="julia.html">Julia</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">KFF Tungregning  </a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Submitting jobs</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/uio-ccse/kff-tungregning-user-guide/blob/main/info_til_brukere/jobs.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="submitting-jobs">
<h1>Submitting jobs<a class="headerlink" href="#submitting-jobs" title="Permalink to this heading"></a></h1>
<p>We use the queueing system <a class="reference external" href="https://slurm.schedmd.com/documentation.html">Slurm</a> on most of the cluster nodes. The job is queueing until the requested resources are available. Long simulations should always be executed via Slurm on bigfacet, hugefacet and greatfacet, but short test simulations may be run without Slurm.</p>
<p>There are three ways to submit jobs to the queue, with different applications: <code class="docutils literal notranslate"><span class="pre">srun</span></code>, <code class="docutils literal notranslate"><span class="pre">sbatch</span></code> and <code class="docutils literal notranslate"><span class="pre">salloc</span></code>.</p>
<section id="srun">
<h2><a class="reference external" href="https://slurm.schedmd.com/srun.html">srun</a><a class="headerlink" href="#srun" title="Permalink to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">srun</span></code> command is used when a job has to be run in an interactive way. This means that the job outputs directly to the terminal, like it would if it was executed without Slurm. A consequence is that the terminal cannot be used while the job is running, which is inconvinient if the queue is long or the job takes long time.</p>
<section id="syntax">
<h3>Syntax<a class="headerlink" href="#syntax" title="Permalink to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>srun<span class="w"> </span>&lt;srun-arguments&gt;<span class="w"> </span>&lt;executable&gt;
</pre></div>
</div>
</section>
<section id="an-example">
<h3>An example<a class="headerlink" href="#an-example" title="Permalink to this heading"></a></h3>
<p>An example where an executable <code class="docutils literal notranslate"><span class="pre">lmp</span></code> runs on two nodes á 16 CPUs looks like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>srun<span class="w"> </span>--partition<span class="o">=</span>normal<span class="w"> </span>--job-name<span class="o">=</span>CPU-job<span class="w"> </span>--ntasks<span class="o">=</span><span class="m">32</span><span class="w"> </span>--nodes<span class="o">=</span><span class="m">2</span><span class="w"> </span>mpirun<span class="w"> </span>lmp
</pre></div>
</div>
</section>
</section>
<section id="sbatch">
<h2><a class="reference external" href="https://slurm.schedmd.com/sbatch.html">sbatch</a><a class="headerlink" href="#sbatch" title="Permalink to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">sbatch</span></code> command is used when running jobs in the background. This means that what would usually output to the terminal is stored in a text file with default name <code class="docutils literal notranslate"><span class="pre">slurm-&lt;job-id&gt;.out</span></code>. Moreover, <code class="docutils literal notranslate"><span class="pre">sbatch</span></code> requires a job script where SBATCH arguments are used to describe how to execute some code. Most of the arguments are the same for both <code class="docutils literal notranslate"><span class="pre">srun</span></code> and <code class="docutils literal notranslate"><span class="pre">sbatch</span></code>, but job arrays are supported by <code class="docutils literal notranslate"><span class="pre">sbatch</span></code> only.</p>
<section id="id1">
<h3>Syntax<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sbatch<span class="w"> </span>&lt;job-script&gt;
</pre></div>
</div>
</section>
<section id="id2">
<h3>An example<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<p>A simple job script where one runs the executable <code class="docutils literal notranslate"><span class="pre">lmp</span></code> on two nodes á 16 CPUs could look like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --partition=normal</span>
<span class="c1">#SBATCH --job-name=test</span>
<span class="c1">#SBATCH --ntasks=32</span>
<span class="c1">#SBATCH --nodes=2</span>

mpirun<span class="w"> </span>lmp
</pre></div>
</div>
<p>and can be submitted with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sbatch<span class="w"> </span>job.sh
</pre></div>
</div>
<p>where job.sh is the name of the job script.</p>
</section>
</section>
<section id="salloc">
<h2><a class="reference external" href="https://slurm.schedmd.com/salloc.html">salloc</a><a class="headerlink" href="#salloc" title="Permalink to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">salloc</span></code> command can be used to allocate a part of a node or an entire node. This can be useful when running interactive programs, for instance notebooks. The command sets up an interactive shell with access to the requested resources. A program executed from this shell will only have access to the requested resourses.</p>
<section id="id3">
<h3>Syntax<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>salloc<span class="w"> </span>&lt;salloc-arguments&gt;
</pre></div>
</div>
</section>
<section id="example-1-cpu">
<h3>Example 1: CPU<a class="headerlink" href="#example-1-cpu" title="Permalink to this heading"></a></h3>
<p>Below is a simple <code class="docutils literal notranslate"><span class="pre">salloc</span></code> command where 2 nodes with 32 CPUs are allocated for an hour:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>salloc<span class="w"> </span>--job-name<span class="o">=</span>salloc<span class="w"> </span>--ntasks<span class="o">=</span><span class="m">32</span><span class="w"> </span>--nodes<span class="o">=</span><span class="m">2</span><span class="w"> </span>--time<span class="o">=</span><span class="m">01</span>:00:00<span class="w"> </span>--exclusive
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">exclusive</span></code> argument indicates that other users are not allowed to run on the requested resources, even if there is available capacity.</p>
</section>
<section id="example-2-gpu">
<h3>Example 2: GPU<a class="headerlink" href="#example-2-gpu" title="Permalink to this heading"></a></h3>
<p>The command <code class="docutils literal notranslate"><span class="pre">salloc</span></code> can also be used to allocate one or multiple GPUs. To allocate two CPU cores and a GPU, run the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>salloc<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>-c<span class="w"> </span><span class="m">2</span><span class="w"> </span>--gres<span class="o">=</span>gpu:1<span class="w"> </span>--job-name<span class="o">=</span>salloc<span class="w"> </span>--time<span class="o">=</span><span class="m">01</span>:00:00
</pre></div>
</div>
<p>Do not use the <code class="docutils literal notranslate"><span class="pre">exclusive</span></code> argument for GPUs, unless you allocate all GPUs on the node.</p>
</section>
</section>
<section id="other-useful-slurm-commands">
<h2>Other useful Slurm commands<a class="headerlink" href="#other-useful-slurm-commands" title="Permalink to this heading"></a></h2>
<section id="squeue">
<h3><a class="reference external" href="https://slurm.schedmd.com/squeue.html">squeue</a><a class="headerlink" href="#squeue" title="Permalink to this heading"></a></h3>
<p>The command <code class="docutils literal notranslate"><span class="pre">squeue</span></code> presents the queue and priorities.</p>
</section>
<section id="sinfo">
<h3><a class="reference external" href="https://slurm.schedmd.com/sinfo.html">sinfo</a><a class="headerlink" href="#sinfo" title="Permalink to this heading"></a></h3>
<p>The command <code class="docutils literal notranslate"><span class="pre">sinfo</span></code> provides an overview of the different resources (available, occupied, down).</p>
</section>
<section id="scancel">
<h3><a class="reference external" href="https://slurm.schedmd.com/scancel.html">scancel</a><a class="headerlink" href="#scancel" title="Permalink to this heading"></a></h3>
<p>The command <code class="docutils literal notranslate"><span class="pre">scancel</span></code> is used to cancel jobs.</p>
<p><em>Example</em>: Cancel job with job-ID 1234:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>scancel<span class="w"> </span><span class="m">1234</span>
</pre></div>
</div>
<p><em>Example</em>: Cancel all jobs associated with the user <code class="docutils literal notranslate"><span class="pre">egil</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>scancel<span class="w"> </span>--user<span class="w"> </span>egil
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="home_directory.html" class="btn btn-neutral float-left" title="Home directory" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="history.html" class="btn btn-neutral float-right" title="History" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, KFF Tungregning.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>